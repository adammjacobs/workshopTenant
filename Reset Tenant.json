{"blocks":[{"id":"FC2E3830-B761-4EC6-BA1F-0C7C67378F9F","type":"StartBlock","disabled":false,"name":"Start","displayName":"Start","comment":"","childId":"E7E2D2B6-F7D8-4A5D-8388-6EDCDF27A482","inputs":[{"id":"run_mode","value":"scheduled","type":"select","structure":{}},{"id":"schedule_start","value":"2021-10-10 17:00:00","type":"date","structure":{}},{"id":"schedule_stoptime","value":null,"type":"date","structure":{}},{"id":"schedule_interval","value":"604800","type":"select","structure":{}},{"id":"schedule_timezone","value":"America/New_York","type":"select","structure":{}}],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":100,"y":100},{"id":"E15B9D20-2B69-4A5C-82BA-EA94F2581837","type":"SnippetBlock","disabled":false,"name":"CreateAttachmentHeroCard","displayName":"Microsoft Teams - Create Attachment Hero Card","comment":"Creates a card with a button to pass to a teams message","childId":"8397846A-F7F1-4399-B1EB-3568A99AD382","inputs":[{"id":"596c8d40-3891-11eb-aa9b-13fc9f76d66f","value":null,"type":"string","structure":[]},{"id":"596d55a0-3891-11eb-950f-d38a8bda5db8","value":null,"type":"string","structure":[]},{"id":"596dae50-3891-11eb-8685-6d17ad8e0746","value":null,"type":"string","structure":[]},{"id":"596df1f0-3891-11eb-bc15-9d479b91bb14","value":null,"type":"string","structure":[]},{"id":"596eb5e0-3891-11eb-ba89-914d062eeadc","value":"Navigate to Tenant","type":"string","structure":[]},{"id":"596f5b40-3891-11eb-9c55-15b274e246c3","value":"https://{ $.getCurrentTenantInfo.hostnames[0] }","type":"string","structure":[]},{"id":"596fa780-3891-11eb-be56-df58ae726e4b","value":null,"type":"string","structure":[]},{"id":"596ff000-3891-11eb-815c-ab45395b23f7","value":null,"type":"string","structure":[]}],"settings":[{"id":"datasource","value":null,"type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":209,"y":2711,"datasourcetype_guid":"0d87af8f-27c0-11ea-921c-022e6b5ea1e2","snippet_guid":"4edc17b0-3645-11eb-a0ed-c3aa945804a7"},{"id":"8397846A-F7F1-4399-B1EB-3568A99AD382","type":"EndpointBlock","disabled":false,"name":"sendMessage2","displayName":"Microsoft Teams - Send Message 2","comment":"Message indicating that the Alias hostname has been removed, and includes a card with a link to the tenant.","childId":null,"inputs":[{"id":"ce80c8c0-d33a-11eb-a1be-fb85dcd48977","value":"0368de63-5b59-4141-97bc-d2adb003542b","type":"string","displayValue":"Public Sector SAs","structure":[]},{"id":"ce8be4d0-d33a-11eb-aa74-37bc58fc7293","value":"19:e9022eb3606c4d9fb965ff4aac4f2bcf@thread.skype","type":"string","displayValue":"Workshops","structure":[]},{"id":"ce9788f0-d33a-11eb-a754-31a1e548ae07","value":"<h1 style=\"color:green;\"><strong>Alias hostname removed</strong></h1><div><p>\nTenant reset\n</p></div>","type":"string","structure":[]},{"id":"cebb4240-d33a-11eb-86c4-cf0a4f744ace","value":"{$.CreateAttachmentHeroCard}","type":"string","structure":[]}],"settings":[{"id":"datasource","value":null,"type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":118,"y":1050,"datasourcetype_guid":"0d87af8f-27c0-11ea-921c-022e6b5ea1e2","endpoint_guid":"ce5ffe30-d33a-11eb-b284-3955388e8c59","endpoint_role":"create"},{"id":"F6DCD72A-EA9E-4B9A-A30C-BC965B27F1EA","type":"CallWidgetBlock","disabled":false,"name":"callAutomation","displayName":"Delete User Apps and Automations - Call Automation","comment":"Set to \"Delete User Apps and Automations\"","childId":"B2EBE95B-2408-48C0-A244-BA27087DBD74","inputs":[{"id":"guid","value":"f4fe1810-8ec9-11ee-83f5-8dcd0852d3dc","type":"api-search","displayValue":"Delete User Apps and Automations","structure":[]}],"settings":[{"id":"blendr_on_error","value":"warning","type":"select","displayValue":"Warning - Continue Automation and report errors","structure":[]},{"id":"cache","value":null,"type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":770,"y":645},{"id":"B2EBE95B-2408-48C0-A244-BA27087DBD74","type":"IfElseBlock","disabled":false,"name":"condition","displayName":"Condition","comment":"","childId":"5A63249F-DF03-43E0-B9EF-604A0A376C97","inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{$.callAutomation[0]}","input2":"Success","operator":"="}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":129,"y":659,"childTrueId":null,"childFalseId":"5A091D53-5E11-4C2A-9943-88079222D704"},{"id":"5A091D53-5E11-4C2A-9943-88079222D704","type":"VariableBlock","disabled":false,"name":"Errors","displayName":"Variable - Errors","comment":"","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":235,"y":864,"variableGuid":"488FB7C0-B4ED-4957-A3F2-82B19752AF89","operations":[{"id":"append","key":"D65B61D6-BF2C-4117-8A3D-289DDE3F63AB","name":"Append to { variable }","value":"Delete User Apps / Automations,"}]},{"id":"5A63249F-DF03-43E0-B9EF-604A0A376C97","type":"CallWidgetBlock","disabled":false,"name":"callAutomation2","displayName":"Republish Apps - Call Automation 2","comment":"Set to \"Republish Apps\"","childId":"42BFD578-CA0C-4AC4-867A-3EA3496EED94","inputs":[{"id":"guid","value":"8bb6ccc0-8ec9-11ee-987a-fdbb8a91cfac","type":"api-search","displayValue":"Republish Apps","structure":[]}],"settings":[{"id":"blendr_on_error","value":"warning","type":"select","displayValue":"Warning - Continue Automation and report errors","structure":[]},{"id":"cache","value":null,"type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":123,"y":1023},{"id":"D7223C9D-1986-4AE6-8429-BB90098944A5","type":"VariableBlock","disabled":false,"name":"Errors","displayName":"Variable - Errors","comment":"","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":447.75,"y":890,"variableGuid":"488FB7C0-B4ED-4957-A3F2-82B19752AF89","operations":[{"id":"append","key":"D65B61D6-BF2C-4117-8A3D-289DDE3F63AB","name":"Append to { variable }","value":"Republish Apps,"}]},{"id":"42BFD578-CA0C-4AC4-867A-3EA3496EED94","type":"IfElseBlock","disabled":false,"name":"condition2","displayName":"Condition 2","comment":"","childId":"FFD4497F-A13F-4D09-8962-0938E2C9E1C0","inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{$.callAutomation2[0]}","input2":"Success","operator":"="}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":542,"y":674,"childTrueId":null,"childFalseId":"D7223C9D-1986-4AE6-8429-BB90098944A5"},{"id":"FFD4497F-A13F-4D09-8962-0938E2C9E1C0","type":"CallWidgetBlock","disabled":false,"name":"callAutomation3","displayName":"Clear Distribute Tags - Call Automation 3","comment":"Set to \"Clear Distribute Tags\"","childId":"C9282DED-12BC-48A2-85DE-375C91E7ACD5","inputs":[{"id":"guid","value":"e140eea0-8ec9-11ee-bf3a-fbca913c3208","type":"api-search","displayValue":"Clear Distribute Tags","structure":[]}],"settings":[{"id":"blendr_on_error","value":"warning","type":"select","displayValue":"Warning - Continue Automation and report errors","structure":[]},{"id":"cache","value":null,"type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":98,"y":1495},{"id":"65D51061-CE77-46F7-B85D-2577675C1341","type":"VariableBlock","disabled":false,"name":"Errors","displayName":"Variable - Errors","comment":"","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":447.75,"y":1375,"variableGuid":"488FB7C0-B4ED-4957-A3F2-82B19752AF89","operations":[{"id":"append","key":"D65B61D6-BF2C-4117-8A3D-289DDE3F63AB","name":"Append to { variable }","value":"Clear Distribute Tags,"}]},{"id":"C9282DED-12BC-48A2-85DE-375C91E7ACD5","type":"IfElseBlock","disabled":false,"name":"condition3","displayName":"Condition 3","comment":"","childId":"EE690408-5299-450C-8641-4A5DCB592A4E","inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{$.callAutomation3[0]}","input2":"Success","operator":"="}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":546,"y":1155,"childTrueId":null,"childFalseId":"65D51061-CE77-46F7-B85D-2577675C1341"},{"id":"A3A4F07C-84AF-4000-9E26-7CDF4FF861D4","type":"CallWidgetBlock","disabled":false,"name":"callAutomation4","displayName":"Delete Workshop Users and Miscellaneous Content - Call Automation 4","comment":"Set to \"Delete Workshop Users and Miscellaneous Content\"","childId":"E08C07B0-69BD-4D26-975B-4624A93E3E28","inputs":[{"id":"guid","value":"c6642360-8ec9-11ee-a891-ff11f3dc2eac","type":"api-search","displayValue":"Delete Workshop Users and Miscellaneous Content","structure":[]}],"settings":[{"id":"blendr_on_error","value":"warning","type":"select","displayValue":"Warning - Continue Automation and report errors","structure":[]},{"id":"cache","value":null,"type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":121,"y":1984},{"id":"CC474537-0488-4971-BC06-F84E8A73DBFB","type":"VariableBlock","disabled":false,"name":"Errors","displayName":"Variable - Errors","comment":"","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":220,"y":2340,"variableGuid":"488FB7C0-B4ED-4957-A3F2-82B19752AF89","operations":[{"id":"append","key":"D65B61D6-BF2C-4117-8A3D-289DDE3F63AB","name":"Append to { variable }","value":"Delete Workshop Users and Miscellaneous Content,"}]},{"id":"E08C07B0-69BD-4D26-975B-4624A93E3E28","type":"IfElseBlock","disabled":false,"name":"condition4","displayName":"Condition 4","comment":"","childId":"45832844-A3EC-4668-8A9E-4F972E417A23","inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{$.callAutomation4[0]}","input2":"Success","operator":"="}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":544,"y":1645,"childTrueId":null,"childFalseId":"CC474537-0488-4971-BC06-F84E8A73DBFB"},{"id":"4E181B75-C763-4457-943C-DA6376CC1BF5","type":"SnippetBlock","disabled":false,"name":"CreateAttachmentHeroCard2","displayName":"Microsoft Teams - Create Attachment Hero Card 2","comment":"Creates a card with a button to pass to a teams message","childId":"0F9F9A7E-7E9A-49EE-B950-9981313BC912","inputs":[{"id":"596c8d40-3891-11eb-aa9b-13fc9f76d66f","value":null,"type":"string","structure":[]},{"id":"596d55a0-3891-11eb-950f-d38a8bda5db8","value":null,"type":"string","structure":[]},{"id":"596dae50-3891-11eb-8685-6d17ad8e0746","value":null,"type":"string","structure":[]},{"id":"596df1f0-3891-11eb-bc15-9d479b91bb14","value":null,"type":"string","structure":[]},{"id":"596eb5e0-3891-11eb-ba89-914d062eeadc","value":"Navigate to Tenant","type":"string","structure":[]},{"id":"596f5b40-3891-11eb-9c55-15b274e246c3","value":"https://{ $.getCurrentTenantInfo.hostnames[0] }","type":"string","structure":[]},{"id":"596fa780-3891-11eb-be56-df58ae726e4b","value":null,"type":"string","structure":[]},{"id":"596ff000-3891-11eb-815c-ab45395b23f7","value":null,"type":"string","structure":[]}],"settings":[{"id":"datasource","value":null,"type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":201,"y":2603,"datasourcetype_guid":"0d87af8f-27c0-11ea-921c-022e6b5ea1e2","snippet_guid":"4edc17b0-3645-11eb-a0ed-c3aa945804a7"},{"id":"0F9F9A7E-7E9A-49EE-B950-9981313BC912","type":"EndpointBlock","disabled":false,"name":"sendMessage","displayName":"Microsoft Teams - Send Message","comment":"Throws an error in teams and reports which automations failed.","childId":null,"inputs":[{"id":"ce80c8c0-d33a-11eb-a1be-fb85dcd48977","value":"0368de63-5b59-4141-97bc-d2adb003542b","type":"string","displayValue":"Public Sector SAs","structure":[]},{"id":"ce8be4d0-d33a-11eb-aa74-37bc58fc7293","value":"19:e9022eb3606c4d9fb965ff4aac4f2bcf@thread.skype","type":"string","displayValue":"Workshops","structure":[]},{"id":"ce9788f0-d33a-11eb-a754-31a1e548ae07","value":"<h1 style=\"color:red;\"><strong>The following automations failed:</strong></h1><div><p>\n{replace: {rtrim: {$.Errors}, ','}, ',', ', '}\n</p></div>","type":"string","structure":[]},{"id":"cebb4240-d33a-11eb-86c4-cf0a4f744ace","value":"{$.CreateAttachmentHeroCard2}","type":"string","structure":[]}],"settings":[{"id":"datasource","value":null,"type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":534,"y":2618,"datasourcetype_guid":"0d87af8f-27c0-11ea-921c-022e6b5ea1e2","endpoint_guid":"ce5ffe30-d33a-11eb-b284-3955388e8c59","endpoint_role":"create"},{"id":"45832844-A3EC-4668-8A9E-4F972E417A23","type":"IfElseBlock","disabled":false,"name":"condition5","displayName":"Condition 5","comment":"Did any automations fail?","childId":null,"inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{$.Errors}","input2":null,"operator":"notEmpty"}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":110,"y":2770,"childTrueId":"4E181B75-C763-4457-943C-DA6376CC1BF5","childFalseId":"E15B9D20-2B69-4A5C-82BA-EA94F2581837"},{"id":"EE690408-5299-450C-8641-4A5DCB592A4E","type":"CallWidgetBlock","disabled":false,"name":"callAutomation5","displayName":"Remove Notes - Call Automation 5","comment":"Set to \"Remove Notes\"","childId":"9F6FB07E-3148-4B25-9F04-550D7681A4FD","inputs":[{"id":"guid","value":"aa146c40-8ec9-11ee-bff7-e34805c68021","type":"api-search","displayValue":"Remove Notes","structure":[]}],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":null,"type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":515,"y":2346},{"id":"9F6FB07E-3148-4B25-9F04-550D7681A4FD","type":"IfElseBlock","disabled":false,"name":"condition6","displayName":"Condition 6","comment":"","childId":"A3A4F07C-84AF-4000-9E26-7CDF4FF861D4","inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{$.callAutomation5[0]}","input2":"Success","operator":"="}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":504,"y":2480,"childTrueId":null,"childFalseId":"8A9F2D8B-295D-4A65-806D-B67DF33236D5"},{"id":"8A9F2D8B-295D-4A65-806D-B67DF33236D5","type":"VariableBlock","disabled":false,"name":"Errors","displayName":"Variable - Errors","comment":"","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":470,"y":2340,"variableGuid":"488FB7C0-B4ED-4957-A3F2-82B19752AF89","operations":[{"id":"append","key":"D65B61D6-BF2C-4117-8A3D-289DDE3F63AB","name":"Append to { variable }","value":"Remove Notes,"}]},{"id":"E7E2D2B6-F7D8-4A5D-8388-6EDCDF27A482","type":"EndpointBlock","disabled":false,"name":"getCurrentTenantInfo","displayName":"Qlik Cloud Services - Get Current Tenant Info","comment":"","childId":"40D471BA-D143-4F40-A6A1-BD75E778244D","inputs":[],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":723,"y":529,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"55051480-cb86-11ec-b746-892c1d04114e","endpoint_role":"get"},{"id":"40D471BA-D143-4F40-A6A1-BD75E778244D","type":"SnippetBlock","disabled":false,"name":"GetTenantNameAndRegion","displayName":"Qlik Platform Operations - Get Tenant Name And Region","comment":"","childId":"508CBD31-BD5C-4E2F-ABCB-05BED61EE79E","inputs":[{"id":"575d1740-b1e2-11ed-958a-598edfec33b8","value":"{ substr: { $.getCurrentTenantInfo.links.self.href }, 0, { strpos: { $.getCurrentTenantInfo.links.self.href }, '/api' } }","type":"string","structure":[]}],"settings":[{"id":"datasource","value":null,"type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":412,"y":316,"datasourcetype_guid":"c7e48240-e0f2-11ec-ada1-d5ef75014b77","snippet_guid":"bd5c1ce0-ad14-11ed-83f6-1d42e53790dd"},{"id":"508CBD31-BD5C-4E2F-ABCB-05BED61EE79E","type":"EndpointBlock","disabled":false,"name":"rawAPIRequest","displayName":"Qlik Platform Operations - Raw API Request","comment":"","childId":"F6DCD72A-EA9E-4B9A-A30C-BC965B27F1EA","inputs":[{"id":"19e52df0-5c20-11ed-8b89-078a912eaf10","value":"{ $.GetTenantNameAndRegion }","type":"string","structure":[]},{"id":"19eb53b0-5c20-11ed-b358-619dca928cfa","value":"tenants/{ $.getCurrentTenantInfo.id }","type":"string","structure":[]},{"id":"7b5cfaf0-5c20-11ed-bd1d-d1dbb9ea3429","value":"901e1ad0-5c20-11ed-85e6-c96a1f18a2ba","type":"select","displayValue":"PATCH","structure":[]},{"id":"aca01a60-5c20-11ed-85a4-35ba2e22c38f","value":"{ json: '[{\"op\": \"replace\",\"path\": \"/hostnames/1\",\"value\": \"\"}]' }","type":"object","mode":"raw","structure":[]},{"id":"bf43d290-5c20-11ed-8501-c390d4a64178","value":null,"type":"object","mode":"keyValue","structure":[]}],"settings":[{"id":"datasource","value":null,"type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":100,"y":580,"datasourcetype_guid":"c7e48240-e0f2-11ec-ada1-d5ef75014b77","endpoint_guid":"19c95e90-5c20-11ed-947d-53935198322e","endpoint_role":"get"}],"variables":[{"guid":"D6EF73EA-09C9-4409-8496-9F8380A49017","name":"hostname","type":"string"},{"guid":"488FB7C0-B4ED-4957-A3F2-82B19752AF89","name":"Errors","type":"string"}]}