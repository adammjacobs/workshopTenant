{"blocks":[{"id":"754D4DF9-B3B6-4D12-B3C8-1A9351D4BF81","type":"StartBlock","disabled":false,"name":"Start","displayName":"Start","comment":"","childId":"BE527811-A62B-4318-9467-6615171E611E","inputs":[{"id":"run_mode","value":"scheduled","type":"select","structure":{}},{"id":"schedule_start","value":"2023-12-03 17:00:00","type":"date","structure":{}},{"id":"schedule_stoptime","value":null,"type":"date","structure":{}},{"id":"schedule_interval","value":"3600","type":"select","structure":{}},{"id":"schedule_timezone","value":"America/New_York","type":"select","structure":{}}],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":58,"y":-14},{"id":"BE527811-A62B-4318-9467-6615171E611E","type":"EndpointBlock","disabled":false,"name":"getCurrentTenantInfo","displayName":"Qlik Cloud Services - Get Current Tenant Info","comment":"","childId":"3322B58B-2A53-4DD9-874D-C44382117C51","inputs":[],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":58,"y":566,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"55051480-cb86-11ec-b746-892c1d04114e","endpoint_role":"get"},{"id":"3322B58B-2A53-4DD9-874D-C44382117C51","type":"SnippetBlock","disabled":false,"name":"GetTenantNameAndRegion","displayName":"Qlik Platform Operations - Get Tenant Name And Region","comment":"","childId":"671CE392-65E7-41B3-9B6D-845BFB2B66F0","inputs":[{"id":"575d1740-b1e2-11ed-958a-598edfec33b8","value":"{ host: { $.getCurrentTenantInfo.links.self.href } }","type":"string","structure":[]}],"settings":[{"id":"datasource","value":null,"type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":58,"y":706,"datasourcetype_guid":"c7e48240-e0f2-11ec-ada1-d5ef75014b77","snippet_guid":"bd5c1ce0-ad14-11ed-83f6-1d42e53790dd"},{"id":"F2BDCA88-8F80-486A-BADC-5937330E8922","type":"EndpointBlock","disabled":false,"name":"DeleteDataFile","displayName":"Qlik Platform Operations - Delete Data File","comment":"","childId":null,"inputs":[{"id":"f7e7b480-d863-11ed-a28a-370787b39f57","value":"{ $.GetTenantNameAndRegion }","type":"string","structure":[]},{"id":"f7eef030-d863-11ed-908a-53c868154f98","value":"{ $.ListDataFilesFromSpace2.item.id }","type":"string","structure":[]}],"settings":[{"id":"datasource","value":null,"type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":298,"y":1906,"datasourcetype_guid":"c7e48240-e0f2-11ec-ada1-d5ef75014b77","endpoint_guid":"f7d86270-d863-11ed-a50a-f77431b8290d","endpoint_role":"delete"},{"id":"C650ADC5-D225-47BA-9687-6DE823252921","type":"EndpointBlock","disabled":false,"name":"listSpaces","displayName":"Qlik Cloud Services - List Spaces","comment":"","childId":null,"inputs":[],"settings":[{"id":"maxitemcount","value":"","type":"string","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-180,"y":814,"loopBlockId":"1A7E83BD-5B74-42EB-8517-D4079433CAA2","datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"42815920-5f18-11eb-8321-91b1587b6c06","endpoint_role":"list"},{"id":"671CE392-65E7-41B3-9B6D-845BFB2B66F0","type":"EndpointBlock","disabled":false,"name":"getCurrentUserId","displayName":"Qlik Cloud Services - Get Current User Id","comment":"","childId":"49F9EBDD-93C7-4825-8F0C-695871A7D05F","inputs":[],"settings":[{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-254,"y":245,"datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"6e9dbaa0-c7a4-11ea-9bd3-0da55b4cbed9","endpoint_role":"get"},{"id":"49F9EBDD-93C7-4825-8F0C-695871A7D05F","type":"EndpointBlock","disabled":false,"name":"listUsers","displayName":"Qlik Cloud Services - List Users","comment":"","childId":"C650ADC5-D225-47BA-9687-6DE823252921","inputs":[],"settings":[{"id":"maxitemcount","value":"","type":"string","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-299,"y":86,"loopBlockId":"3957A81B-AA89-4A6E-A45C-099FAFD9B602","datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"53ca52b0-6f83-11eb-b06c-c5bdc3525ce4","endpoint_role":"list"},{"id":"3957A81B-AA89-4A6E-A45C-099FAFD9B602","type":"EndpointBlock","disabled":false,"name":"listDataFiles","displayName":"Qlik Cloud Services - List Data Files","comment":"","childId":"86B5B0D6-E666-462F-BF39-14E6B8335C10","inputs":[{"id":"44da6400-f548-11ed-b69c-cd1f00885bf2","value":null,"type":"select","structure":[]},{"id":"5872f750-f548-11ed-8f4f-e153b2253f62","value":null,"type":"string","structure":[]},{"id":"bc104e50-f548-11ed-86e3-85b622a1703f","value":null,"type":"string","structure":[]},{"id":"eb7555a0-f548-11ed-b6a4-733648ff08a4","value":null,"type":"string","structure":[]},{"id":"00770740-f549-11ed-b0fa-afe239113bad","value":"{ $.listUsers.item.id }","type":"string","structure":[]}],"settings":[{"id":"maxitemcount","value":"","type":"string","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-270,"y":416,"loopBlockId":"9D9864F1-A789-450E-8110-3048F2F8B18A","datasourcetype_guid":"61a87510-c7a3-11ea-95da-0fb0c241e75c","endpoint_guid":"1250db90-f548-11ed-bb5c-31311462577f","endpoint_role":"list"},{"id":"9D9864F1-A789-450E-8110-3048F2F8B18A","type":"IfElseBlock","disabled":false,"name":"condition2","displayName":"Condition 2","comment":"","childId":"FFACBB49-3B10-4841-A38C-94FC31913F7F","inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{ $.listDataFiles.item.ownerId }","input2":"{ $.getCurrentUserId }","operator":"!="},{"input1":"{ $.listDataFiles.item.name }","input2":"cityGeo.qvd","operator":"!="},{"input1":"{ $.listDataFiles.item.name }","input2":"cityAliases.qvd","operator":"!="},{"input1":"{ $.listDataFiles.item.name }","input2":"countryGeo.qvd","operator":"!="}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":-305,"y":530,"childTrueId":"00035831-C345-4B19-BDED-F11410B77F9F","childFalseId":null},{"id":"FFACBB49-3B10-4841-A38C-94FC31913F7F","type":"EndpointBlock","disabled":false,"name":"DeleteDataFile2","displayName":"Qlik Platform Operations - Delete Data File 2","comment":"","childId":null,"inputs":[{"id":"f7e7b480-d863-11ed-a28a-370787b39f57","value":"{ $.GetTenantNameAndRegion }","type":"string","structure":[]},{"id":"f7eef030-d863-11ed-908a-53c868154f98","value":"{ $.listDataFiles.item.id }","type":"string","structure":[]}],"settings":[{"id":"datasource","value":null,"type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":360,"y":920,"datasourcetype_guid":"c7e48240-e0f2-11ec-ada1-d5ef75014b77","endpoint_guid":"f7d86270-d863-11ed-a50a-f77431b8290d","endpoint_role":"delete"},{"id":"00035831-C345-4B19-BDED-F11410B77F9F","type":"EndpointBlock","disabled":false,"name":"ChangeDataFileOwner","displayName":"Qlik Platform Operations - Change Data File Owner","comment":"","childId":null,"inputs":[{"id":"842c17d0-f963-11ed-a721-2528ebd7c656","value":"{ $.GetTenantNameAndRegion }","type":"string","structure":[]},{"id":"84339850-f963-11ed-bd9d-67b12608eb6a","value":"{ $.listDataFiles.item.id }","type":"string","structure":[]},{"id":"843ee920-f963-11ed-a54a-39f55e8ed332","value":"{ $.getCurrentUserId }","type":"string","structure":[]}],"settings":[{"id":"datasource","value":null,"type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":240,"y":920,"datasourcetype_guid":"c7e48240-e0f2-11ec-ada1-d5ef75014b77","endpoint_guid":"841b8440-f963-11ed-808d-03748ef4d7d3","endpoint_role":"create"},{"id":"86B5B0D6-E666-462F-BF39-14E6B8335C10","type":"IfElseBlock","disabled":false,"name":"condition3","displayName":"Condition 3","comment":"","childId":null,"inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{ implode: { $.listUsers.item.roles }, ',' }","input2":"Admin","operator":"contain"}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":-606,"y":714,"childTrueId":"084522E2-2B97-4CDD-978B-A93C138DF795","childFalseId":null},{"id":"084522E2-2B97-4CDD-978B-A93C138DF795","type":"VariableBlock","disabled":false,"name":"adminUsers","displayName":"Variable - adminUsers","comment":"","childId":null,"inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-615,"y":1548,"variableGuid":"D6918CF2-1338-4CD5-8EDD-DFA6113AFFDB","operations":[{"id":"append","key":"170AEA3C-8655-4FD6-8484-11B8D829D1E2","name":"Append to { variable }","value":"{ $.listUsers.item.id },"}]},{"id":"1A7E83BD-5B74-42EB-8517-D4079433CAA2","type":"SnippetBlock","disabled":false,"name":"ListDataFilesFromSpace2","displayName":"Qlik Platform Operations - List Data Files From Space 2","comment":"","childId":null,"inputs":[{"id":"d8e58e20-fa31-11ed-b2ac-0fffc605aad3","value":"{ $.GetTenantNameAndRegion }","type":"string","structure":[]},{"id":"d8e63580-fa31-11ed-af74-112f69c5deee","value":"{ $.listSpaces.item.id }","type":"string","structure":[]}],"settings":[{"id":"datasource","value":null,"type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":647,"y":1748,"loopBlockId":"55C47291-269E-4707-8005-2BDCA4A22B06","datasourcetype_guid":"c7e48240-e0f2-11ec-ada1-d5ef75014b77","snippet_guid":"f8db6b60-fa26-11ed-b985-a3ee665e0cb9"},{"id":"55C47291-269E-4707-8005-2BDCA4A22B06","type":"IfElseBlock","disabled":false,"name":"condition4","displayName":"Condition 4","comment":"","childId":null,"inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{ $.ListDataFilesFromSpace2.item.ownerId }","operator":"!=","input2":"{ $.adminUsers }"},{"input1":"{ $.listSpaces.item.description }","operator":"!=","input2":"Data"}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":-232,"y":1610,"childTrueId":"F2BDCA88-8F80-486A-BADC-5937330E8922","childFalseId":null}],"variables":[{"guid":"6C24B9B0-8607-4D49-AEC6-0ABF0B5C3E9B","name":"workshopData","type":"string"},{"guid":"70946B3D-5F66-4AA9-A554-03EE27DF1E11","name":"message","type":"string"},{"guid":"0706302B-D7C2-43A3-BBD6-3409A7A3BE7C","name":"fileCount","type":"number"},{"guid":"D4D07856-ED88-4BFE-8D40-EEAE0F615D50","name":"tenantHostname","type":"string"},{"guid":"38517AA4-A15F-4AF9-9D1D-E0C15DD5F8B4","name":"dataSpace","type":"string"},{"guid":"D6918CF2-1338-4CD5-8EDD-DFA6113AFFDB","name":"adminUsers","type":"string"}]}